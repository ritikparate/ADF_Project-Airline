{
	"name": "Data Transformation",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "sinked",
						"type": "DatasetReference"
					},
					"name": "bookingsdatagit"
				},
				{
					"dataset": {
						"referenceName": "githubjson",
						"type": "DatasetReference"
					},
					"name": "airportdetailssql"
				},
				{
					"dataset": {
						"referenceName": "onpremtest",
						"type": "DatasetReference"
					},
					"name": "airlineonpremtest"
				},
				{
					"dataset": {
						"referenceName": "passengeronprem",
						"type": "DatasetReference"
					},
					"name": "passengeronprem"
				},
				{
					"dataset": {
						"referenceName": "flightonprem",
						"type": "DatasetReference"
					},
					"name": "flightonprem"
				}
			],
			"sinks": [
				{
					"linkedService": {
						"referenceName": "ls_datalake",
						"type": "LinkedServiceReference"
					},
					"name": "bookingssink"
				},
				{
					"linkedService": {
						"referenceName": "ls_datalake",
						"type": "LinkedServiceReference"
					},
					"name": "flightsink"
				},
				{
					"linkedService": {
						"referenceName": "ls_datalake",
						"type": "LinkedServiceReference"
					},
					"name": "airportsink"
				},
				{
					"linkedService": {
						"referenceName": "ls_datalake",
						"type": "LinkedServiceReference"
					},
					"name": "airlinesink"
				},
				{
					"linkedService": {
						"referenceName": "ls_datalake",
						"type": "LinkedServiceReference"
					},
					"name": "passengersink"
				}
			],
			"transformations": [
				{
					"name": "capitlizetocountry"
				},
				{
					"name": "agegenderfromINDIA"
				},
				{
					"name": "selectcols"
				},
				{
					"name": "checkingstatustrue"
				},
				{
					"name": "changeformatforGender"
				},
				{
					"name": "indianairline"
				},
				{
					"name": "capitlizecountry"
				},
				{
					"name": "countrycapitlize"
				},
				{
					"name": "countrytoindia"
				},
				{
					"name": "filterbyairport"
				},
				{
					"name": "UpsertAirIndia"
				},
				{
					"name": "captilizeflightnumber"
				},
				{
					"name": "blankupsert1"
				},
				{
					"name": "blankupsert2"
				},
				{
					"name": "blankupsert3"
				},
				{
					"name": "blankupsert4"
				}
			],
			"scriptLines": [
				"source(output(",
				"          airline_id as short,",
				"          booking_date as string,",
				"          booking_id as short,",
				"          checkin_status as boolean,",
				"          destination_airport_id as short,",
				"          flight_duration_mins as short,",
				"          flight_id as short,",
				"          origin_airport_id as short,",
				"          passenger_id as short,",
				"          ticket_cost as double",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     documentForm: 'documentPerLine') ~> bookingsdatagit",
				"source(output(",
				"          airport_id as short,",
				"          airport_name as string,",
				"          city as string,",
				"          country as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     documentForm: 'documentPerLine') ~> airportdetailssql",
				"source(output(",
				"          airline_id as string,",
				"          airline_name as string,",
				"          country as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     format: 'parquet') ~> airlineonpremtest",
				"source(output(",
				"          passenger_id as string,",
				"          full_name as string,",
				"          gender as string,",
				"          age as integer,",
				"          country as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     format: 'parquet') ~> passengeronprem",
				"source(output(",
				"          flight_id as string,",
				"          flight_number as string,",
				"          departure_time as string,",
				"          arrival_time as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     format: 'parquet') ~> flightonprem",
				"airlineonpremtest derive(country = upper(country)) ~> capitlizetocountry",
				"capitlizecountry filter(and(and(age>25 , gender == 'Male'),country == 'INDIA')) ~> agegenderfromINDIA",
				"bookingsdatagit select(mapColumn(",
				"          airline_id,",
				"          booking_date,",
				"          checkin_status,",
				"          destination_airport_id,",
				"          flight_duration_mins,",
				"          origin_airport_id,",
				"          passenger_id,",
				"          ticket_cost",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> selectcols",
				"filterbyairport filter(and(and(checkin_status,ticket_cost>500),flight_duration_mins <150)) ~> checkingstatustrue",
				"passengeronprem derive(gender = iif(gender == 'M','Male','Female')) ~> changeformatforGender",
				"capitlizetocountry filter(country == 'INDIA') ~> indianairline",
				"changeformatforGender derive(country = upper(country)) ~> capitlizecountry",
				"airportdetailssql derive(country = upper(country)) ~> countrycapitlize",
				"countrycapitlize filter(country == 'INDIA') ~> countrytoindia",
				"selectcols filter(and(or(destination_airport_id == 3,origin_airport_id==3),airline_id == 3)) ~> filterbyairport",
				"captilizeflightnumber alterRow(upsertIf(like(flight_number,'AI%'))) ~> UpsertAirIndia",
				"flightonprem derive(flight_number = upper(flight_number)) ~> captilizeflightnumber",
				"checkingstatustrue alterRow(upsertIf(1==1)) ~> blankupsert1",
				"countrytoindia alterRow(upsertIf(1==1)) ~> blankupsert2",
				"indianairline alterRow(upsertIf(1==1)) ~> blankupsert3",
				"agegenderfromINDIA alterRow(upsertIf(1==1)) ~> blankupsert4",
				"blankupsert1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'delta',",
				"     fileSystem: 'silver',",
				"     folderPath: 'Bookings',",
				"     mergeSchema: false,",
				"     autoCompact: false,",
				"     optimizedWrite: false,",
				"     vacuum: 0,",
				"     deletable: false,",
				"     insertable: true,",
				"     updateable: false,",
				"     upsertable: false,",
				"     keys:['airline_id'],",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> bookingssink",
				"UpsertAirIndia sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'delta',",
				"     fileSystem: 'silver',",
				"     folderPath: 'Flights',",
				"     mergeSchema: false,",
				"     autoCompact: false,",
				"     optimizedWrite: false,",
				"     vacuum: 0,",
				"     deletable: false,",
				"     insertable: true,",
				"     updateable: false,",
				"     upsertable: false,",
				"     keys:['flight_id'],",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> flightsink",
				"blankupsert2 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'delta',",
				"     fileSystem: 'silver',",
				"     folderPath: 'AirportDetails',",
				"     mergeSchema: false,",
				"     autoCompact: false,",
				"     optimizedWrite: false,",
				"     vacuum: 0,",
				"     deletable: false,",
				"     insertable: true,",
				"     updateable: false,",
				"     upsertable: false,",
				"     keys:['airport_id'],",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> airportsink",
				"blankupsert3 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'delta',",
				"     fileSystem: 'silver',",
				"     folderPath: 'Airline',",
				"     mergeSchema: false,",
				"     autoCompact: false,",
				"     optimizedWrite: false,",
				"     vacuum: 0,",
				"     deletable: false,",
				"     insertable: true,",
				"     updateable: false,",
				"     upsertable: false,",
				"     keys:['airline_id'],",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> airlinesink",
				"blankupsert4 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'delta',",
				"     fileSystem: 'silver',",
				"     folderPath: 'Passengers',",
				"     mergeSchema: false,",
				"     autoCompact: false,",
				"     optimizedWrite: false,",
				"     vacuum: 0,",
				"     deletable: false,",
				"     insertable: true,",
				"     updateable: false,",
				"     upsertable: false,",
				"     keys:['passenger_id'],",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> passengersink"
			]
		}
	}
}